(function(){"use strict";window.KR=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;return j=null,d=[],b=[],a=[],c=[],i=!1,h=new google.maps.InfoWindow({content:""}),e=["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],f=[{elementType:"geometry",stylers:[{visibility:"simplified"},{saturation:-45},{lightness:13},{gamma:.7},{weight:.3},{hue:"#0077ff"}]},{elementType:"labels",stylers:[{visibility:"simplified"}]},{elementType:"geometry.stroke",stylers:[{color:"#000000"}]}],u=function(){return w(),o()},s=function(){return 0===$(".intro").length?$(".loader").remove():void 0},F=function(){return $(".loader").fadeIn(1e3)},E=function(){return $(".legend").removeClass("hide").addClass("fadeInUpBig"),$("header").removeClass("hide").addClass("fadeInDownBig")},o=function(){return $("#gotoviz").on("click",function(){return i===!0?$(".loader").remove():($(".intro").remove(),$(".inner-loader").removeClass("hide"))})},w=function(){var a;return j=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(23.5674244,85.7557826),zoom:5,maxZoom:9,minZoom:3,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"custom"]},mapTypeId:"custom",streetViewControl:!1}),j.data.loadGeoJson("./data/india.geojson",{idPropertyName:"NAME_1"}),v(),a=new google.maps.StyledMapType(f,{name:"Jass"}),j.mapTypes.set("custom",a),j.data.setStyle(H),google.maps.event.addListenerOnce(j.data,"addfeature",function(){x(),B(),C(),i=!0,s(),E()})},k=function(){return $(".legend-list li").removeClass("active")},p=function(a){var b;return $(".details").hasClass("fadeInRightBig")||$(".details").removeClass("hide").addClass("fadeInRightBig"),$(".details-empty").hide(),a.feature.getProperty("state")?(j.data.setStyle(H),j.data.revertStyle(),a.feature.removeProperty("state"),void 0):(j.data.forEach(function(a){return a.removeProperty("state")}),j.data.setStyle(D),j.data.revertStyle(),b=e[m(a.feature.getProperty("value"))],j.data.overrideStyle(a.feature,{fillOpacity:1,strokeWeight:2,strokeColor:"#fff",fillColor:b}),r(a),a.feature.setProperty("state","active"))},r=function(a){var b,c,d,e;return d=a.feature.getProperty("NAME_1"),b=a.feature.getProperty("value"),c=a.feature.getProperty("total_accidents"),e=m(b),k(),$(".legend-list li:nth-child("+e+")").addClass("active"),$(".state-name").text(d),$(".accidents_2012").text(b),$(".accidents_2012_total").text(c),z(d),A(d),y(d)},q=function(a){return a.feature.setProperty("state","normal"),k()},v=function(){return j.data.addListener("mouseover",t),j.data.addListener("click",p),j.data.addListener("mouseout",I)},t=function(a){var b;return b=e[m(a.feature.getProperty("value"))],j.data.overrideStyle(a.feature,{fillOpacity:1,strokeWeight:3,strokeColor:"#eee",fillColor:b})},I=function(a){return"active"!==a.feature.getProperty("state")?j.data.revertStyle(a.feature):void 0},G=function(a){var b;return j.data.overrideStyle(a.feature,{strokeColor:"white",strokeWeight:2}),h.setContent("supberb awesome cooll sutff..."),b=new google.maps.MVCObject,b.set("position",a.latLng),h.open(j,b)},C=function(){return $.ajax({url:"data/total-accidents-vehicle.json",dataType:"JSON",success:function(a){return a.data.forEach(function(a){return L(a)}),l()}})},L=function(a){return c[$.trim(a[0])+""]={key:$.trim(a[0])+"",values:[{label:"Two-Wheelers",icon:"bike.svg",value:parseInt(a[1])},{label:"Cars, Jeeps, Taxis",icon:"car.svg",value:parseInt(a[9])},{label:"Auto-Rickshaws",icon:"auto.svg",value:parseInt(a[5])},{label:"Other Motor Vehicles",icon:"other.svg",value:parseInt(a[21])},{label:"Trucks, Tempos, MAVs, Tractors",icon:"truck.svg",value:parseInt(a[17])},{label:"Buses",icon:"bus.svg",value:parseInt(a[13])}]}},B=function(){return $.ajax({url:"data/accident-cause-2012.json",dataType:"JSON",success:function(a){return a.data.forEach(function(a){return J(a)})}})},J=function(b){return a[$.trim(b[0])+""]={key:$.trim(b[0])+"",values:[{label:"Fault of Driver",value:b[1]},{label:"Fault of Cyclist",value:b[4]},{label:"Fault of Pedestrian",value:b[7]},{label:"Condition of Motor Vehicle",value:b[10]},{label:"Defect in Road Condition",value:b[13]},{label:"Weather Condition",value:b[16]},{label:"Other Causes",value:b[19]}]}},x=function(){return $.ajax({url:"data/total-accidents-2009-2012.json",dataType:"JSON",success:function(a){return a.data.forEach(function(a){var b;return b=j.data.getFeatureById($.trim(a[0])+""),b.setProperty("value",parseFloat(a[8])),b.setProperty("total_accidents",parseInt(a[1])),d.push(parseFloat(a[8])),K(a)}),g()}})},K=function(a){return b[$.trim(a[0])]={total:[{key:"Total Accidents",values:[{x:"2009",y:parseFloat(a[1])},{x:"2010",y:parseFloat(a[2])},{x:"2011",y:parseFloat(a[3])},{x:"2012",y:parseFloat(a[4])}]}]}},D=function(a){var b;return b=!0,(null==a.getProperty("value")||isNaN(a.getProperty("value")))&&(b=!1),{strokeWeight:0,strokeColor:"#fff",fillColor:e[m(a.getProperty("value"))],fillOpacity:.5,visible:b}},H=function(a){var b,c,d,f;return c=!0,(null==a.getProperty("value")||isNaN(a.getProperty("value")))&&(c=!1),b=.5,f=1,"hover"===a.getProperty("state")&&(b=1.5,f=2),"active"===a.getProperty("state")&&(b=1.5,f=2,d="#000"),{strokeWeight:b,strokeColor:"#fff",zIndex:f,fillColor:e[m(a.getProperty("value"))],fillOpacity:.9,visible:c}},m=function(a){var b;return b=d3.scale.quantile().domain(d).range(d3.range(8))(a),parseInt(b)},n=function(){return d3.scale.quantile().domain(d).range(d3.range(8)).quantiles()},l=function(){var a,b,d,e,f;for(a=0,e=c["Andhra Pradesh"].values,d="",f=[];a<e.length;)b="<li>\n  <img src='images/icons/"+e[a].icon+'\' alt="">\n  <span>'+e[a].label+"</span>\n</li>",$(".vehicle-legend").append($(b)),f.push(a++);return f},g=function(){var a,b,c,d,f;for(a=0,d=n(),c="",f=[];a<d.length;)b="<li class='legend-list-item'>\n  <span class='color' style='background-color: "+e[a]+"'> </span>\n  <span> "+parseFloat(d[a-1]||0).toFixed(4)+" - "+parseFloat(d[a]).toFixed(4)+" </span>\n</li>",$(".legend-list").append($(b)),f.push(a++);return f},y=function(a){return nv.addGraph(function(){var b,d;return b=nv.models.discreteBarChart().x(function(a){return a.icon}).y(function(a){return a.value}).staggerLabels(!0).showIcons(!0).showValues(!0).tooltips(!1).showValues(!0).transitionDuration(350).valueFormat(d3.format(",")),d=[{key:"Type of viehicle",values:c[a].values}],console.log(d),d3.select("#detailedVehicleChart svg").datum(d).call(b)})},A=function(b){return nv.addGraph(function(){var c;return c=nv.models.pieChart().x(function(a){return a.label}).y(function(a){return parseInt(a.value)}).labelType("percent").valueFormat(d3.format("")).tooltipContent(function(a,b){return"<h3>"+a+"</h3> <p>"+b+"</p>"}),d3.select("#detailedSplitChart svg").datum(a[b].values).call(c),nv.utils.windowResize(function(){c.update()}),c})},z=function(a){return nv.addGraph(function(){var c;return c=nv.models.lineChart().useInteractiveGuideline(!0).transitionDuration(400).showLegend(!0).showYAxis(!0).showXAxis(!0),c.xAxis.axisLabel("Year"),c.yAxis.axisLabel("Accidents"),d3.select("#detailedChart svg").datum(b[a].total).call(c),nv.utils.windowResize(function(){c.update()}),c})},{map:function(){return j},init:function(){return u(),!0}}}(),$(KR.init)}).call(this);