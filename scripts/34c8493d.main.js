(function(){"use strict";window.KR=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return f=null,c=[],b=[],a=[],d=["#fcbbaf","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],e=[{elementType:"geometry",stylers:[{visibility:"simplified"},{saturation:-45},{lightness:13},{gamma:.7},{weight:.3},{hue:"#0077ff"}]},{elementType:"labels",stylers:[{visibility:"simplified"}]},{elementType:"geometry.stroke",stylers:[{color:"#000000"}]}],m=function(){return o()},l=function(){return $(".loader").fadeOut(function(){return $(this).remove()})},v=function(){return $(".loader").fadeIn(1e3)},u=function(){return $(".legend").removeClass("hide").addClass("fadeInUpBig"),$(".details").removeClass("hide").addClass("fadeInRightBig"),$("header").removeClass("hide").addClass("fadeInDownBig")},o=function(){var a;return f=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(23.5674244,85.7557826),zoom:5,maxZoom:9,minZoom:3,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"custom"]},mapTypeId:"custom",streetViewControl:!1}),f.data.loadGeoJson("./data/india.geojson",{idPropertyName:"NAME_1"}),f.data.setStyle(function(){return{fillColor:"#fff",strokeWeight:1,strokeColor:"#7372BF"}}),n(),a=new google.maps.StyledMapType(e,{name:"Jass"}),f.mapTypes.set("custom",a),f.data.setStyle(w),google.maps.event.addListenerOnce(f.data,"addfeature",function(){p(),s(),l(),u()})},g=function(){return $(".legend-list li").removeClass("active")},i=function(a){return a.feature.setProperty("state","active")},k=function(a){var b,d,e;return d=null!==a?a.feature.getProperty("NAME_1"):"Andhra Pradesh",b=null!==a?a.feature.getProperty("value"):c[0],e=h(b),g(),$(".legend-list li:nth-child("+(e+1)+")").addClass("active"),null!==a&&a.feature.setProperty("state","hover"),$(".state-name").text(d),$(".accidents_2012").text(b),q(d),r(d)},j=function(a){return a.feature.setProperty("state","normal"),g()},n=function(){return f.data.addListener("mouseover",k),f.data.addListener("click",i),f.data.addListener("mouseout",j)},s=function(b){return $.ajax({url:"/data/accident-cause-2012.json",dataType:"JSON",success:function(c){return c.data.forEach(function(c){return b=f.data.getFeatureById($.trim(c[0])+""),a[$.trim(c[0])+""]={key:$.trim(c[0])+"",values:[{label:"Fault of Driver",value:c[1]},{label:"Fault of Cyclist",value:c[4]},{label:"Fault of Pedestrian",value:c[7]},{label:"Condition of Motor Vehicle",value:c[10]},{label:"Defect in Road Condition",value:c[13]},{label:"Weather Condition",value:c[16]},{label:"Other Causes",value:c[19]}]}}),k(null)}})},p=function(){return $.ajax({url:"/data/total-accidents-2003-2012.json",dataType:"JSON",success:function(a){return a.data.forEach(function(a){var d;return d=f.data.getFeatureById($.trim(a[0])+""),d.setProperty("value",parseInt(a[1])),c.push(a[1]),b[$.trim(a[0])]={total:[{key:"Total Accidents",values:[{x:"2003",y:parseInt(a[1])},{x:"2004",y:parseInt(a[2])},{x:"2005",y:parseInt(a[3])},{x:"2006",y:parseInt(a[4])},{x:"2007",y:parseInt(a[5])},{x:"2008",y:parseInt(a[6])},{x:"2009",y:parseInt(a[7])},{x:"2010",y:parseInt(a[8])},{x:"2011",y:parseInt(a[9])},{x:"2012",y:parseInt(a[10])}]}]}})}})},r=function(b){return nv.addGraph(function(){var c;return c=nv.models.pieChart().x(function(a){return a.label}).y(function(a){return parseInt(a.value)}).labelType("percent").showLabels(!1).valueFormat(d3.format("")).tooltipContent(function(a,b){return"<h3>"+a+"</h3> <p>"+b+"</p>"}),d3.select("#detailedSplitChart svg").datum(a[b].values).call(c),nv.utils.windowResize(function(){c.update()}),c})},q=function(a){return nv.addGraph(function(){var c;return c=nv.models.lineChart().useInteractiveGuideline(!0).transitionDuration(400).showLegend(!0).showYAxis(!0).showXAxis(!0),c.xAxis.axisLabel("Year"),c.yAxis.axisLabel("Accidents"),d3.select("#detailedChart svg").datum(b[a].total).call(c),nv.utils.windowResize(function(){c.update()}),c})},t=function(){},h=function(a){var b;return b=0,a>0&&500>a?b=0:a>500&&3e3>a?b=1:a>3e3&&6e3>a?b=2:a>6e3&&12e3>a?b=3:a>12e3&&24e3>a?b=4:a>24e3&&48e3>a?b=5:a>48e3&&7e4>a&&(b=6),b},w=function(a){var b,c,e,f;return c=!0,(null==a.getProperty("value")||isNaN(a.getProperty("value")))&&(c=!1),b=.5,f=1,"hover"===a.getProperty("state")&&(b=1.5,f=2),"active"===a.getProperty("state")&&(b=1.5,f=2,e="#000"),{strokeWeight:b,strokeColor:"#fff",zIndex:f,fillColor:d[h(a.getProperty("value"))],fillOpacity:.9,visible:c}},{init:function(){return m(),!0}}}(),$(KR.init)}).call(this),function(){var a;a=angular.module("app",[]),a.controller("mainCtrl",["$scope",function(a){return a.colors=[{color:"#fcbba1",range:"0 - 500"},{color:"#fcbba1",range:"500 - 3000"},{color:"#fc9272",range:"3000 - 6000"},{color:"#fb6a4a",range:"6000 - 12000"},{color:"#ef3b2c",range:"12000 - 24000"},{color:"#cb181d",range:"24000 - 48000"},{color:"#99000d",range:"48000 - 70000"}]}])}.call(this);